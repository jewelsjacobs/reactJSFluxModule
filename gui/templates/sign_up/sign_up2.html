{% extends 'sign_up/sign_up_base.html' %}

{% block body %}
    {% include 'doubleclick_iframe.html' %}
    {{ super() }}
{% endblock body %}

{% block sidebar %}
    {% call sidebar_help(hidden=False) %}
        <h3>Creating Instances</h3>
        <h4>What Are Instances?</h4>
        <p>Instances are the core of ObjectRocket services. Create an instance that fits your software needs.</p>
        <p><a target="blank" href="http://docs.objectrocket.com/overview_and_concepts.html#instances">More Details About Instances&raquo;</a></p>

        <hr/>
        <h4>All plans include</h4>
        <ul>
            <li>MongoDB {{ default_mongo_version }}
                <a href="http://docs.mongodb.org/manual/release-notes/2.4/" target="1">Release Notes</a>
            </li>
            <li>3 member Replica Set</li>
            <li>Solid State disk (SSD)</li>
            <li>24x7 email Support</li>
        </ul>

        <hr/>
        <h4>Zone</h4>
        <p>This is the location of the datacenter which your instance will exist in.</p>

        <hr/>
        <h4>Plan</h4>
        <p>The plan is the base size of your instance. Each new shard added to your instance will increase your instance size by increments of the plan size you select.</p>

        <p><a target="blank" href="http://docs.objectrocket.com/">Visit Our Knowledge Center &raquo;</a></p>
    {% endcall %}
{% endblock sidebar %}

{% block content_area_body %}
    {% call create_view(url_for('sign_up3'), id="sign-up-form", method="POST") %}
        {% call detail_header(page_title="Sign Up", subtitle="Step 2 of 3") %}{% endcall %}
        {% call detail_section(title="Instance Details") %}
            <div class="rs-control-group">
                <label class="rs-control-label" for="name">Instance Name</label>

                <div class="rs-controls">
                    <input id="name" name="name" type="text" class="rs-input-large">
                </div>
            </div>

            <div class="rs-control-group">
                <label class="rs-control-label" for="zone">Zone</label>

                <div class="rs-controls">
                    <select name="zone" id='zone'>
                        <option value="US-East-IAD3" selected>US-East-IAD3, AWS Direct Connect</option>
                        <option value="US-West">US-West, AWS Direct Connect</option>
                        <option value="US-Chicago">ORD</option>
                        <option value="EU-London">LON</option>
                        <option value="AP-HongKong">HKG</option>
                        <option value="AP-Sydney">SYD</option>
                    </select>
                    <span class="rs-help-block">Datacenter location.
                        <a href="http://www.objectrocket.com/details#datacenters" target="1">Zone Details.</a>
                    </span>
                </div>
            </div>

            <div class="rs-control-group">
                <label class="rs-control-label" for="plan">Plan</label>

                <div class="rs-controls">
                    <select name="plan" id='plan_select'>
                        <option value=1>1GB SMALL $19.00/mo</option>
                        <option value=5 selected>5GB MEDIUM $149.00/mo</option>
                        <option value=20>20GB MEDIUM $399.00/mo</option>
                        <option value=50>50GB MEDIUM $899.00/mo</option>
                        <option value=100>100GB MEDIUM $1599.00/mo</option>
                    </select>
                    <span class="rs-help-block">
                        Instance is incremented in shards of this size
                        <br>
                        (5GB Medium and larger).
                        All prices in USD.
                        <br>
                        <a href="http://www.objectrocket.com/pricing#pricing" target="1">Plan and Pricing
                            Details.</a>
                    </span>
                </div>
            </div>

            <div class="rs-control-group">
                <div class="rs-controls">
                    <a href="{{ url_for('sign_up1') }}" class="rs-btn rs-btn-secondary">Previous</a>
                    <button id="next" type="submit" class="rs-btn rs-btn-primary">Next</button>
                </div>
            </div>

            <input type="hidden" id="service_type" name="service_type" value="mongodb"/>
            <input type="hidden" id="version" name="version" value="{{ default_mongo_version }}"/>
        {% endcall %}
    {% endcall %}

{% endblock content_area_body %}

{% block script %}
    {{ super() }}
    {{ coremetrics_conversion("Signup2") }}

    <script>
        $(document).ready(function () {

            $.validator.addMethod("noSpaces", function (value, element) {
                return value.indexOf(" ") < 0 && value != "";
            }, "Spaces are not permitted in instance names");

            $('#sign-up-form').validate({
                rules: {
                    name: {
                        minlength: 2,
                        alphanumeric: true,
                        required: true
                    }
                },
                errorClass: 'rs-validation-block',
                errorElement: 'span',
                highlight: function (label) {
                    $(label).closest('.rs-control-group').addClass('error');
                },
                success: function (label) {
                    $(label).closest('.rs-control-group').addClass('success');
                    $(label).closest('.rs-control-group').removeClass('error');
                }
            });

            $('#zone').change(function () {
                var selectedZone = $(this).val();

                var usPrices = [
                    {val: 1, text: '1GB SMALL $19.00/mo'},
                    {val: 5, text: '5GB MEDIUM $149.00/mo'},
                    {val: 20, text: '20GB MEDIUM $399.00/mo'},
                    {val: 50, text: '50GB MEDIUM $899.00/mo'},
                    {val: 100, text: '100GB MEDIUM $1,599.00/mo'},
                ];

                var lonPrices = [
                    {val: 1, text: '1GB SMALL $25.00/mo'},
                    {val: 5, text: '5GB MEDIUM $190.00/mo'},
                    {val: 20, text: '20GB MEDIUM $500.00/mo'},
                    {val: 50, text: '50GB MEDIUM $1,125.00/mo'},
                    {val: 100, text: '100GB MEDIUM $2,000.00/mo'},
                ];

                var hkgPrices = [
                    {val: 1, text: '1GB SMALL $25.00/mo'},
                    {val: 5, text: '5GB MEDIUM $195.00/mo'},
                    {val: 20, text: '20GB MEDIUM $525.00/mo'},
                    {val: 50, text: '50GB MEDIUM $1,175.00/mo'},
                    {val: 100, text: '100GB MEDIUM $2,075.00/mo'},
                ];

                var sydPrices = [
                    {val: 1, text: '1GB SMALL $25.00/mo'},
                    {val: 5, text: '5GB MEDIUM $195.00/mo'},
                    {val: 20, text: '20GB MEDIUM $525.00/mo'},
                    {val: 50, text: '50GB MEDIUM $1,175.00/mo'},
                    {val: 100, text: '100GB MEDIUM $2,075.00/mo'},
                ];

                var prices = usPrices;

                if (selectedZone == 'EU-London') {
                    var prices = lonPrices;
                } else if (selectedZone == 'AP-HongKong') {
                    var prices = hkgPrices;
                } else if (selectedZone == 'AP-Sydney') {
                    var prices = sydPrices;
                }

                $('#plan_select').empty();

                $(prices).each(function () {
                    $('#plan_select').append($("<option>").attr('value', this.val).text(this.text));
                });

                $('#plan_select').val(5);
            });
        });
    </script>

    {{ xg4ken_conversion(200, 'object') }}
    {% include 'everest_conversion_js.html' %}
{% endblock script %}
