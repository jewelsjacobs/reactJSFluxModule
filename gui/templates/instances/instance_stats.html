{% extends 'web_app_base.html' %}

{% block title %}
    Instance Statistics
{% endblock title %}

{% block style %}
    {{ super() }}

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.1.15-beta/nv.d3.css">

    {% include 'stripe_css.html' %}
{% endblock style %}

{% block back_link_area %}
    {% call back_link() %}
        <a href="{{ url_for('instances') }}">&lsaquo; Back to Instances</a>
    {% endcall %}
{% endblock back_link_area %}

{% block content_area_body %}
    <!-- detail header -->
    <div class="rs-detail-header">
        {% call detail_header_actions() %}
            <li><span class="rs-dropdown-category">Views</span></li>
            <li><a class="rs-btn rs-btn-link or-expand-all">Expand All</a></li>
            <li><a class="rs-btn rs-btn-link or-collapse-all">Collapse All</a></li>
        {% endcall %}
        <!-- detail header subtitle -->
        <div class="rs-detail-header-subtitle">Instance Statistics</div>
        <!-- end detail header subtitle -->

        <!-- detail header title -->
        <div class="rs-detail-header-title">{{ instance.name }}</div>
        <!-- end detail header title -->
    </div>
    <!-- end detail header -->

    {% call detail_section(title="Graphs", collapsible=True) %}
		{% raw %}
			<div ng-controller="StatsPageCtrl">
				<div ng-repeat="(key, value) in shards">
					<h4>ReplicaSet: {{key}}</h4>
					<div ng-repeat="host in value" ng-controller="StatsGraphCtrl">
						<div ng-switch on="error">
						    <div ng-switch-when="true">
								There was an error getting your chart!
						    </div>
						    <div ng-switch-default>

						    </div>
						</div>
					</div>
				</div>
			</div>
		{% endraw %}
    {% endcall %}
{% endblock content_area_body %}

{% block script %}
    {{ super() }}

	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0/angular.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.1.15-beta/nv.d3.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.5.0/moment.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/angularjs.nvd3-directives/v0.0.7/angularjs-nvd3-directives.min.js"></script>
	<script type="text/javascript" src="/static/js/stats/stats.js"></script>

	<script type="text/javascript">
		window.app = angular.module("statsGraphApp");
		app.value("instanceName", "{{instance.name}}");
		app.value("apiUrl", "http://localhost:5050");
		angular.bootstrap(document.body , ["statsGraphApp"]);
	</script>

    {% include 'stripe_js.html' %}
{% endblock script %}
